{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///c:/Users/ASUS/OneDrive/Documentos/Men%C3%BAs%20IA/src/components/diner/DinerClient.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const DinerClient = registerClientReference(\n    function() { throw new Error(\"Attempted to call DinerClient() from the server but DinerClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/diner/DinerClient.tsx <module evaluation>\",\n    \"DinerClient\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;AACO,MAAM,cAAc,IAAA,wQAAuB,EAC9C;IAAa,MAAM,IAAI,MAAM;AAAsO,GACnQ,sEACA","ignoreList":[0]}},
    {"offset": {"line": 36, "column": 0}, "map": {"version":3,"sources":["file:///c:/Users/ASUS/OneDrive/Documentos/Men%C3%BAs%20IA/src/components/diner/DinerClient.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const DinerClient = registerClientReference(\n    function() { throw new Error(\"Attempted to call DinerClient() from the server but DinerClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/diner/DinerClient.tsx\",\n    \"DinerClient\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;AACO,MAAM,cAAc,IAAA,wQAAuB,EAC9C;IAAa,MAAM,IAAI,MAAM;AAAsO,GACnQ,kDACA","ignoreList":[0]}},
    {"offset": {"line": 50, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///c:/Users/ASUS/OneDrive/Documentos/Men%C3%BAs%20IA/src/app/%28tenant%29/%5Bslug%5D/page.tsx"],"sourcesContent":["import { notFound } from \"next/navigation\";\r\nimport { createClient } from '@/lib/supabase/server';\r\nimport { DinerClient } from \"@/components/diner/DinerClient\";\r\nimport { MenuItem, Story, Category, RestaurantConfig } from \"@/types\";\r\n\r\ninterface PageProps {\r\n    params: Promise<{\r\n        slug: string;\r\n    }>;\r\n}\r\n\r\n// Tipo para los datos del tenant\r\ninterface TenantData {\r\n    config: RestaurantConfig;\r\n    menu: MenuItem[];\r\n    stories: Story[];\r\n    categories: Category[];\r\n}\r\n\r\n// Función para obtener todos los datos del tenant\r\nasync function getTenantData(slug: string): Promise<TenantData | null> {\r\n    const supabase = await createClient();\r\n\r\n    // 1. Obtener el tenant por slug\r\n    const { data: tenant, error: tenantError } = await supabase\r\n        .from('tenants')\r\n        .select('*')\r\n        .eq('slug', slug)\r\n        .single();\r\n\r\n    if (tenantError || !tenant) {\r\n        return null;\r\n    }\r\n\r\n    // 2. Obtener categorías activas\r\n    const { data: categories, error: categoriesError } = await supabase\r\n        .from('categories')\r\n        .select('id, name, slug, display_order')\r\n        .eq('tenant_id', tenant.id)\r\n        .eq('is_active', true)\r\n        .order('display_order', { ascending: true });\r\n\r\n    if (categoriesError) {\r\n        console.error('Error fetching categories:', categoriesError);\r\n    }\r\n\r\n    // 3. Obtener platos con sus modificadores\r\n    const { data: dishes, error: dishesError } = await supabase\r\n        .from('dishes')\r\n        .select(`\r\n            id,\r\n            name,\r\n            description,\r\n            price,\r\n            image_url,\r\n            available,\r\n            dietary,\r\n            is_popular,\r\n            is_chef_choice,\r\n            is_new,\r\n            category_id,\r\n            dish_option_groups (\r\n                id,\r\n                name,\r\n                min_selections,\r\n                max_selections,\r\n                display_order,\r\n                dish_options (\r\n                    id,\r\n                    name,\r\n                    price,\r\n                    available\r\n                )\r\n            )\r\n        `)\r\n        .eq('tenant_id', tenant.id)\r\n        .eq('available', true)\r\n        .order('name', { ascending: true });\r\n\r\n    if (dishesError) {\r\n        console.error('Error fetching dishes:', dishesError);\r\n    }\r\n\r\n    // 4. Obtener stories activas\r\n    const now = new Date().toISOString();\r\n    const { data: stories, error: storiesError } = await supabase\r\n        .from('stories')\r\n        .select(`\r\n            id,\r\n            title,\r\n            type,\r\n            image_url,\r\n            video_url,\r\n            linked_dish_id\r\n        `)\r\n        .eq('tenant_id', tenant.id)\r\n        .eq('is_active', true)\r\n        .or(`expires_at.is.null,expires_at.gt.${now}`)\r\n        .order('created_at', { ascending: false });\r\n\r\n    if (storiesError) {\r\n        console.error('Error fetching stories:', storiesError);\r\n    }\r\n\r\n    // 5. Construir configuración del restaurante\r\n    const config: RestaurantConfig = {\r\n        id: tenant.id,\r\n        slug: tenant.slug,\r\n        name: tenant.name,\r\n        tagline: tenant.tagline || '',\r\n        coverImage: tenant.cover_url || '',\r\n        logo: tenant.logo_url || undefined,\r\n        theme: {\r\n            colors: {\r\n                primary: tenant.primary_color || '#f59e0b',\r\n                secondary: tenant.secondary_color || '#1f2937',\r\n                accent: tenant.primary_color || '#f59e0b',\r\n                dark: '#030712'\r\n            },\r\n            fonts: {\r\n                sans: tenant.font_family || 'Inter',\r\n                serif: 'Playfair Display'\r\n            }\r\n        },\r\n        currency: tenant.currency || '$'\r\n    };\r\n\r\n    // 6. Construir categorías\r\n    const formattedCategories: Category[] = (categories || []).map(cat => ({\r\n        id: cat.id,\r\n        name: cat.name\r\n    }));\r\n\r\n    // 7. Construir menú\r\n    const menu: MenuItem[] = (dishes || []).map(dish => {\r\n        const category = categories?.find(c => c.id === dish.category_id);\r\n        return {\r\n            id: dish.id,\r\n            name: dish.name,\r\n            description: dish.description || '',\r\n            price: dish.price,\r\n            image: dish.image_url || '',\r\n            category: category?.name || 'Sin categoría',\r\n            tags: dish.dietary || [],\r\n            popular: dish.is_popular || false,\r\n            new: dish.is_new || false,\r\n            chefChoice: dish.is_chef_choice || false,\r\n            available: dish.available,\r\n            modifiers: dish.dish_option_groups?.sort((a, b) => a.display_order - b.display_order).map(group => ({\r\n                id: group.id,\r\n                name: group.name,\r\n                minSelection: group.min_selections,\r\n                maxSelection: group.max_selections,\r\n                options: group.dish_options?.map(opt => ({\r\n                    id: opt.id,\r\n                    name: opt.name,\r\n                    price: opt.price,\r\n                    available: opt.available\r\n                })) || []\r\n            })) || []\r\n        };\r\n    });\r\n\r\n    // 8. Construir stories\r\n    const formattedStories: Story[] = (stories || []).map(story => ({\r\n        id: story.id,\r\n        title: story.title,\r\n        image: story.image_url || '',\r\n        viewed: false,\r\n        type: story.type as 'dish' | 'promo' | 'chef',\r\n        linkedItemId: story.linked_dish_id || undefined\r\n    }));\r\n\r\n    return {\r\n        config,\r\n        menu,\r\n        stories: formattedStories,\r\n        categories: formattedCategories\r\n    };\r\n}\r\n\r\nexport default async function TenantPage({ params }: PageProps) {\r\n    const { slug } = await params;\r\n\r\n    // Obtener datos reales desde Supabase\r\n    const tenantData = await getTenantData(slug);\r\n\r\n    if (!tenantData) {\r\n        notFound();\r\n    }\r\n\r\n    return (\r\n        <DinerClient\r\n            config={tenantData.config}\r\n            menuItems={tenantData.menu}\r\n            stories={tenantData.stories}\r\n            categories={tenantData.categories}\r\n        />\r\n    );\r\n}\r\n\r\n// Generar rutas estáticas para los tenants conocidos (opcional para SSR)\r\nexport function generateStaticParams() {\r\n    // Retornar array vacío para que sea completamente dinámico\r\n    // Si se quiere SSG, obtener slugs de la base de datos aquí\r\n    return [];\r\n}\r\n"],"names":[],"mappings":"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"}}]
}